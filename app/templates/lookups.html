
{% extends 'base.html' %}
{% block navbar %}
<li class="active"><a href="/main">Home</a></li>
{% endblock%}

{% block extrastyle %}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css" rel="stylesheet" />

<link href="static/css/dropzone.css" rel="stylesheet">

{% endblock %}

{% block content %}
 <!-- ======= Breadcrumbs ======= -->
 <section style="margin-top:150px;" class="breadcrumbs">
    <div class="container">

      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex justify-content-between align-items-center">
          <h2>Lookups</h2>
          
        </div>
        <div class="faq-list">
          <button class="nice-button" onclick="location.href='/tokenization'">Back<i style='color:white;'class='icofont-long-arrow-left'></i></button>
          <button class="nice-button" onclick="location.href='edit?file_name=pos'">Edit POS json<i style='color:white;'class='icofont-code-alt'></i></button>
          <button class="nice-button" onclick="location.href='edit?file_name=lemma'">Edit Lemma json<i style='color:white;'class='icofont-code-alt'></i></button>
          <button class="nice-button" onclick="location.href='edit?file_name=entity'">Edit Entity json<i style='color:white;'class='icofont-code-alt'></i></button>
          <button class="nice-button" onclick="location.href='/texts'">Next<i style='color:white;'class='icofont-long-arrow-right'></i></button>
         </div>  
        
        
        
        
    </div><br>
    <p>Lookups tables allow Cadet to automatically bulk update your
      annotations to save time. This method eliminates the need to re-enter information every time that it
      appears in your corpus. Keep in mind that simple lookups do not account for context or semantic variation.
      The table cannot predict if "Chicago" is a place, a theater, or a musical. If you add "Chicago" as a place
      lookup, all matching tokens in your corpus will be marked as "place." You will have the opportunity to
      adjust these values during annotation, but you'll need to strike a balance between saving time with bulk
      updates and losing time by having to change incorrect annotations.</p>
    </div>
  </section><!-- End Breadcrumbs -->
  <section class="inner-page">
    <div class="container">
      <div class="faq-list">
        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle nice-button" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
            Select type of lookup to update
          </button>
          <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
            <li><a class="dropdown-item" href="#">Part of Speech</a></li>
            <li><a  class="dropdown-item" href="#">Lemmata</a></li>
            <li><a class="dropdown-item" href="#">Entities</a></li>
          </ul>
        </div>
        
       </div>  
  <form id='dropzone' action="/upload_lookups" class="dropzone" enctype="multipart/form-data" method="post">                   
    <div class="dz-message" data-dz-message><span></span></div>

  </form>
  </div>
  </section>


  
</main><!-- End #main -->
    {% endblock %}

  {% block extrajs %}
  <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
  <script src="static/js/dropzone.js"></script>
  <script>
  let dz = Dropzone.options.dropzone = {
      dictDefaultMessage: "",
      timeout: 300000000,
      init: function() {
        
        //POST sent with file and form data
        this.on("sending", function(file, xhr, formData){
          formData.append("lookup_type", selected_type);
          $('#spinner').show();
          
  
        //When upload completed, #TODO need event for tesseract complete
        this.on("success", function(data) { 
            
            let texts_html = data.xhr.responseText;
            let text_results = document.getElementById('text_results');
            text_results.innerHTML = texts_html;
            $('#spinner').hide();
            //setTimeout(() => {  get_texts(); }, 3000);
          }
        );
      });
    }
  };

  let selected_type = null;
  $(".dropdown-item:contains('Part of Speech')").click(function() {
    $('.dz-message').text('Click here or drag files to upload your part of speech data');
    selected_type = 'pos';
  });
  $(".dropdown-item:contains('Lemmata')").click(function() {
    $('.dz-message').text('Click here or drag files to upload your lemma data');
    selected_type = 'lemma';
  });
  $(".dropdown-item:contains('Entities')").click(function() {
    $('.dz-message').text('Click here or drag files to upload your entities data');
    selected_type = 'ent';
  });
  $('#header').addClass('header-scrolled');

  </script>
  
  {% endblock %}